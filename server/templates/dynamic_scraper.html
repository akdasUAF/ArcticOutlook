{% extends 'base.html' %}

{% block head %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dynamic.css') }}">
    <title>Dynamic Scraper</title>
    
{% endblock %}

{% block body %}
<a class="return" href="{{ url_for('index') }}">Return to Main Page</a>
<div id="main">  
{% if scrape == True %}
    <div id="output">
        <h2>Output</h2>
        <form id="download" method="POST">
            <input type="submit" name="download" value="Download as csv">
        </form>
        <p>Link: {{url}} </p>
        <table>
            <thead>
              <tr>
                <th>Name</th>
                <th>Value</th>
              </tr>
            </thead>
            <tbody>
            {% for key, value in iter.items() %}
             <tr>
                 <td> {{ key }} </td>
                 <td> {{ value[0] }} </td>
             </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
{% endif %}

    <div id="selections">
        <div id="list">
            {% if url_needed == True %}
            <p>Please input the url of the items you would like to scrape.</p>
            <p class="error">{{error}}</p>
            {% else %}
                <p>Please input the css-selectors of the items you would like to scrape.</p>
                <p class="error">{{error}}</p>
                <p><b>Submitted Items</b>:</p>
                {% if items_submitted==True %}
                <table>
                    <thead>
                      <tr>
                        <th>Name</th>
                        <th>CSS-Selector</th>
                      </tr>
                    </thead>
                    <tbody>
                    {% for key, value in result.items() %}
                     <tr>
                         <td> {{ key }} </td>
                         <td> {{ value }} </td>
                     </tr>
                    {% endfor %}
                    </tbody>
                </table>
                {% endif %}
            {% endif %}
        </div>
    </div>
        <div id="form">
            {% if url_needed == True %}
            <form method="POST" id="url_submit">
                <p><label for="url"><b>URL Link</b></label>
                <br>Example: any operator link found here 
                https://dec.alaska.gov/Applications/Water/OpCert/Home.aspx?p=OperatorSearchResults&name=&city=
                <input name="url" type="text"></p>
                <input type="submit" name="url_submit" value="Submit URL">
            </form>
            {% else %}
            <form method="POST" id="scrape">
                <p>URL: {{url}} </p>
                <p>For a simple scrape, provide the name of the scraped item and the css-selector path to the item in the html.
                    To acquire the css-selector, right click on the item you wish to scrape and press 'inspect'. This will take you to the 
                    exact item in the developer tools. Simply right click the item in the developer tools and press 'Copy > CSS-Selector'. You can 
                    then paste the item into the proper text bar. Leave the dropdown as 'None'.
                </p>
                <p>Additionally, you can specify a few options. If 'Link' is selected in the drop down, the scraper will try to pull every link from
                    the specified selector. If 'table' is selected, it will attempt to retrieve all the information from the table (minus the header).
                </p>
                <p><label for="name">Item Name (Example: 'Operator Name')</label>
                <input type="text" name="name"></p>
                <p><label for="item">New css-selector (Example: '#ctl00_ContentPlaceHolder1_ctl00_lblName')</label>
                <input type="text" name="item"></p>
                <label for="arg_select">Choose what to return in item:</label>
                <select id="arg_select" name="arg_select">
                    <option value="none">None</option>
                    <option value="table">Table</option>
                    <option value="href">Link</option>
                <input type="submit" name="add_item" value="Add Item"></input>
                <input type="submit" name="scrape" value="Start Scrape"/> 
            </form>
            {% endif %}
        </div>
</div>
{% endblock %}